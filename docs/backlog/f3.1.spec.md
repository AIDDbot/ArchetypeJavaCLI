# F3.1 Resolve location via IP (ip-api.com)

## Context

- Epic: E3 Weather Command
- Depends on: F2.1 Reactive HTTP client with timeouts, F2.2 External endpoints configuration
- Project: Archetype Java CLI

## User stories

1. As a user, when I run the `weather` command without coordinates, the CLI SHALL resolve my approximate location using my public IP so the command can fetch weather for my location.

## Acceptance criteria (EARS)

- SHALL: The CLI SHALL call the configured IP Geolocation API when latitude/longitude are not provided.
  - WHEN the `weather` command is invoked without coordinates
  - IF the IP Geolocation call returns a valid location
  - THEN the CLI SHALL use the returned latitude and longitude to continue the weather retrieval flow

- SHALL: The CLI SHALL fail with a clear, user-facing error and an appropriate exit code WHEN the IP Geolocation call fails due to network issues or invalid responses.
  - WHEN the IP Geolocation API call times out or returns an error status
  - IF the call cannot provide usable coordinates
  - THEN the CLI SHALL print a concise error message and exit with a NETWORK or UNKNOWN exit code depending on the failure

## Notes

- Use the existing `WebClient` bean and `CliProperties.Endpoints.ipGeoBaseUrl` for the base URL.
- Keep the implementation minimal: a small `IpGeoClient` service that maps only the fields we need (lat, lon, status/message).
- Map ip-api JSON shape partially; do not introduce a heavy dependency.
